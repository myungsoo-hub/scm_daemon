select subject, icoop_code,bar_code,subject3,s1, s2,[2018-01-01],[2018-01-02],[2018-01-03],[2018-01-04],[2018-01-05],[2018-01-06],[2018-01-07],[2018-01-08],[2018-01-09],[2018-01-10],[2018-01-11],[2018-01-12],[2018-01-13],[2018-01-14],[2018-01-15],[2018-01-16],[2018-01-17],[2018-01-18],[2018-01-19],[2018-01-20],[2018-01-21],[2018-01-22],[2018-01-23],[2018-01-24],[2018-01-25],[2018-01-26],[2018-01-27],[2018-01-28],[2018-01-29],[2018-01-30],[2018-01-31],[2018-02-01],[2018-02-02],[2018-02-03],[2018-02-04],[2018-02-05],[2018-02-06],[2018-02-07],[2018-02-08],[2018-02-09],[2018-02-10],[2018-02-11],[2018-02-12],[2018-02-13],[2018-02-14],[2018-02-15],[2018-02-16],[2018-02-17],[2018-02-18],[2018-02-19],[2018-02-20],[2018-02-21],[2018-02-22],[2018-02-23],[2018-02-24],[2018-02-25],[2018-02-26],[2018-02-27],[2018-02-28],[2018-03-01],[2018-03-02],[2018-03-03],[2018-03-04],[2018-03-05],[2018-03-06],[2018-03-07],[2018-03-08],[2018-03-09],[2018-03-10],[2018-03-11],[2018-03-12],[2018-03-13],[2018-03-14],[2018-03-15],[2018-03-16],[2018-03-17],[2018-03-18],[2018-03-19],[2018-03-20],[2018-03-21],[2018-03-22],[2018-03-23],[2018-03-24],[2018-03-25],[2018-03-26],[2018-03-27],[2018-03-28],[2018-03-29],[2018-03-30],[2018-03-31],[2018-04-01],[2018-04-02],[2018-04-03],[2018-04-04],[2018-04-05],[2018-04-06],[2018-04-07],[2018-04-08],[2018-04-09],[2018-04-10],[2018-04-11],[2018-04-12],[2018-04-13],[2018-04-14],[2018-04-15],[2018-04-16],[2018-04-17],[2018-04-18],[2018-04-19],[2018-04-20],[2018-04-21],[2018-04-22],[2018-04-23],[2018-04-24],[2018-04-25],[2018-04-26],[2018-04-27],[2018-04-28],[2018-04-29],[2018-04-30],[2018-05-01],[2018-05-02],[2018-05-03],[2018-05-04],[2018-05-05],[2018-05-06],[2018-05-07],[2018-05-08],[2018-05-09],[2018-05-10],[2018-05-11],[2018-05-12],[2018-05-13],[2018-05-14],[2018-05-15],[2018-05-16],[2018-05-17],[2018-05-18],[2018-05-19],[2018-05-20],[2018-05-21],[2018-05-22],[2018-05-23],[2018-05-24],[2018-05-25],[2018-05-26],[2018-05-27],[2018-05-28],[2018-05-29],[2018-05-30],[2018-05-31],[2018-06-01],[2018-06-02],[2018-06-03],[2018-06-04],[2018-06-05],[2018-06-06],[2018-06-07],[2018-06-08],[2018-06-09],[2018-06-10],[2018-06-11],[2018-06-12],[2018-06-13],[2018-06-14],[2018-06-15],[2018-06-16],[2018-06-17],[2018-06-18],[2018-06-19],[2018-06-20],[2018-06-21],[2018-06-22],[2018-06-23],[2018-06-24],[2018-06-25],[2018-06-26],[2018-06-27],[2018-06-28],[2018-06-29],[2018-06-30],[2018-07-01],[2018-07-02],[2018-07-03],[2018-07-04],[2018-07-05],[2018-07-06],[2018-07-07],[2018-07-08],[2018-07-09],[2018-07-10],[2018-07-11],[2018-07-12],[2018-07-13],[2018-07-14],[2018-07-15],[2018-07-16],[2018-07-17],[2018-07-18],[2018-07-19],[2018-07-20],[2018-07-21],[2018-07-22],[2018-07-23],[2018-07-24],[2018-07-25],[2018-07-26],[2018-07-27],[2018-07-28],[2018-07-29],[2018-07-30],[2018-07-31],[2018-08-01],[2018-08-02],[2018-08-03],[2018-08-04],[2018-08-05],[2018-08-06],[2018-08-07],[2018-08-08],[2018-08-09],[2018-08-10],[2018-08-11],[2018-08-12],[2018-08-13],[2018-08-14],[2018-08-15],[2018-08-16],[2018-08-17],[2018-08-18],[2018-08-19],[2018-08-20],[2018-08-21],[2018-08-22],[2018-08-23],[2018-08-24],[2018-08-25],[2018-08-26],[2018-08-27],[2018-08-28],[2018-08-29],[2018-08-30],[2018-08-31],[2018-09-01],[2018-09-02],[2018-09-03],[2018-09-04],[2018-09-05],[2018-09-06],[2018-09-07],[2018-09-08],[2018-09-09],[2018-09-10],[2018-09-11],[2018-09-12],[2018-09-13],[2018-09-14],[2018-09-15],[2018-09-16],[2018-09-17],[2018-09-18],[2018-09-19],[2018-09-20],[2018-09-21],[2018-09-22],[2018-09-23],[2018-09-24],[2018-09-25],[2018-09-26],[2018-09-27],[2018-09-28],[2018-09-29],[2018-09-30],[2018-10-01],[2018-10-02],[2018-10-03],[2018-10-04],[2018-10-05],[2018-10-06],[2018-10-07],[2018-10-08],[2018-10-09],[2018-10-10],[2018-10-11],[2018-10-12],[2018-10-13],[2018-10-14],[2018-10-15],[2018-10-16],[2018-10-17],[2018-10-18],[2018-10-19],[2018-10-20],[2018-10-21],[2018-10-22],[2018-10-23],[2018-10-24],[2018-10-25],[2018-10-26],[2018-10-27],[2018-10-28],[2018-10-29],[2018-10-30],[2018-10-31],[2018-11-01],[2018-11-02],[2018-11-03],[2018-11-04],[2018-11-05],[2018-11-06],[2018-11-07],[2018-11-08],[2018-11-09],[2018-11-10],[2018-11-11],[2018-11-12],[2018-11-13],[2018-11-14],[2018-11-15],[2018-11-16],[2018-11-17],[2018-11-18],[2018-11-19],[2018-11-20],[2018-11-21],[2018-11-22],[2018-11-23],[2018-11-24],[2018-11-25],[2018-11-26],[2018-11-27],[2018-11-28],[2018-11-29],[2018-11-30],[2018-12-01],[2018-12-02],[2018-12-03],[2018-12-04],[2018-12-05],[2018-12-06],[2018-12-07],[2018-12-08],[2018-12-09],[2018-12-10],[2018-12-11],[2018-12-12],[2018-12-13],[2018-12-14],[2018-12-15],[2018-12-16],[2018-12-17],[2018-12-18],[2018-12-19],[2018-12-20],[2018-12-21],[2018-12-22],[2018-12-23],[2018-12-24],[2018-12-25],[2018-12-26],[2018-12-27],[2018-12-28],[2018-12-29],[2018-12-30],[2018-12-31]
from (
select orderdate,b.subject, icoop_code, bar_code,c.subject3,f.subject as s1, d.subject as s2, sum(a.qty_total - a.qty_discount) as sum_jungga 
from pos_sale_A01_ppm_daily as a
LEFT OUTER JOIN pos_product_master as b WITH (NOLOCK) ON a.ppmidx = b.idx 
LEFT OUTER JOIN pos_db_BrandClass as c WITH (NOLOCK) ON b.pdbidx = c.idx
LEFT OUTER JOIN pos_category_master as d WITH (NOLOCK) ON b.pcmidx = d.idx 
LEFT OUTER JOIN pos_category_group as f WITH (NOLOCK) ON d.pcgidx = f.idx
where a.storeno ='8000006151' and (orderdate >= '2018-01-01' and orderdate <='2018-12-31')and  b.icoop_code in
(select icoop_code from test)
group by orderdate,bar_code,b.subject,c.subject3,f.subject, d.subject,icoop_code
) T
	Pivot (sum(sum_jungga) For orderdate in ([2018-01-01],[2018-01-02],[2018-01-03],[2018-01-04],[2018-01-05],[2018-01-06],[2018-01-07],[2018-01-08],[2018-01-09],[2018-01-10],[2018-01-11],[2018-01-12],[2018-01-13],[2018-01-14],[2018-01-15],[2018-01-16],[2018-01-17],[2018-01-18],[2018-01-19],[2018-01-20],[2018-01-21],[2018-01-22],[2018-01-23],[2018-01-24],[2018-01-25],[2018-01-26],[2018-01-27],[2018-01-28],[2018-01-29],[2018-01-30],[2018-01-31],[2018-02-01],[2018-02-02],[2018-02-03],[2018-02-04],[2018-02-05],[2018-02-06],[2018-02-07],[2018-02-08],[2018-02-09],[2018-02-10],[2018-02-11],[2018-02-12],[2018-02-13],[2018-02-14],[2018-02-15],[2018-02-16],[2018-02-17],[2018-02-18],[2018-02-19],[2018-02-20],[2018-02-21],[2018-02-22],[2018-02-23],[2018-02-24],[2018-02-25],[2018-02-26],[2018-02-27],[2018-02-28],[2018-03-01],[2018-03-02],[2018-03-03],[2018-03-04],[2018-03-05],[2018-03-06],[2018-03-07],[2018-03-08],[2018-03-09],[2018-03-10],[2018-03-11],[2018-03-12],[2018-03-13],[2018-03-14],[2018-03-15],[2018-03-16],[2018-03-17],[2018-03-18],[2018-03-19],[2018-03-20],[2018-03-21],[2018-03-22],[2018-03-23],[2018-03-24],[2018-03-25],[2018-03-26],[2018-03-27],[2018-03-28],[2018-03-29],[2018-03-30],[2018-03-31],[2018-04-01],[2018-04-02],[2018-04-03],[2018-04-04],[2018-04-05],[2018-04-06],[2018-04-07],[2018-04-08],[2018-04-09],[2018-04-10],[2018-04-11],[2018-04-12],[2018-04-13],[2018-04-14],[2018-04-15],[2018-04-16],[2018-04-17],[2018-04-18],[2018-04-19],[2018-04-20],[2018-04-21],[2018-04-22],[2018-04-23],[2018-04-24],[2018-04-25],[2018-04-26],[2018-04-27],[2018-04-28],[2018-04-29],[2018-04-30],[2018-05-01],[2018-05-02],[2018-05-03],[2018-05-04],[2018-05-05],[2018-05-06],[2018-05-07],[2018-05-08],[2018-05-09],[2018-05-10],[2018-05-11],[2018-05-12],[2018-05-13],[2018-05-14],[2018-05-15],[2018-05-16],[2018-05-17],[2018-05-18],[2018-05-19],[2018-05-20],[2018-05-21],[2018-05-22],[2018-05-23],[2018-05-24],[2018-05-25],[2018-05-26],[2018-05-27],[2018-05-28],[2018-05-29],[2018-05-30],[2018-05-31],[2018-06-01],[2018-06-02],[2018-06-03],[2018-06-04],[2018-06-05],[2018-06-06],[2018-06-07],[2018-06-08],[2018-06-09],[2018-06-10],[2018-06-11],[2018-06-12],[2018-06-13],[2018-06-14],[2018-06-15],[2018-06-16],[2018-06-17],[2018-06-18],[2018-06-19],[2018-06-20],[2018-06-21],[2018-06-22],[2018-06-23],[2018-06-24],[2018-06-25],[2018-06-26],[2018-06-27],[2018-06-28],[2018-06-29],[2018-06-30],[2018-07-01],[2018-07-02],[2018-07-03],[2018-07-04],[2018-07-05],[2018-07-06],[2018-07-07],[2018-07-08],[2018-07-09],[2018-07-10],[2018-07-11],[2018-07-12],[2018-07-13],[2018-07-14],[2018-07-15],[2018-07-16],[2018-07-17],[2018-07-18],[2018-07-19],[2018-07-20],[2018-07-21],[2018-07-22],[2018-07-23],[2018-07-24],[2018-07-25],[2018-07-26],[2018-07-27],[2018-07-28],[2018-07-29],[2018-07-30],[2018-07-31],[2018-08-01],[2018-08-02],[2018-08-03],[2018-08-04],[2018-08-05],[2018-08-06],[2018-08-07],[2018-08-08],[2018-08-09],[2018-08-10],[2018-08-11],[2018-08-12],[2018-08-13],[2018-08-14],[2018-08-15],[2018-08-16],[2018-08-17],[2018-08-18],[2018-08-19],[2018-08-20],[2018-08-21],[2018-08-22],[2018-08-23],[2018-08-24],[2018-08-25],[2018-08-26],[2018-08-27],[2018-08-28],[2018-08-29],[2018-08-30],[2018-08-31],[2018-09-01],[2018-09-02],[2018-09-03],[2018-09-04],[2018-09-05],[2018-09-06],[2018-09-07],[2018-09-08],[2018-09-09],[2018-09-10],[2018-09-11],[2018-09-12],[2018-09-13],[2018-09-14],[2018-09-15],[2018-09-16],[2018-09-17],[2018-09-18],[2018-09-19],[2018-09-20],[2018-09-21],[2018-09-22],[2018-09-23],[2018-09-24],[2018-09-25],[2018-09-26],[2018-09-27],[2018-09-28],[2018-09-29],[2018-09-30],[2018-10-01],[2018-10-02],[2018-10-03],[2018-10-04],[2018-10-05],[2018-10-06],[2018-10-07],[2018-10-08],[2018-10-09],[2018-10-10],[2018-10-11],[2018-10-12],[2018-10-13],[2018-10-14],[2018-10-15],[2018-10-16],[2018-10-17],[2018-10-18],[2018-10-19],[2018-10-20],[2018-10-21],[2018-10-22],[2018-10-23],[2018-10-24],[2018-10-25],[2018-10-26],[2018-10-27],[2018-10-28],[2018-10-29],[2018-10-30],[2018-10-31],[2018-11-01],[2018-11-02],[2018-11-03],[2018-11-04],[2018-11-05],[2018-11-06],[2018-11-07],[2018-11-08],[2018-11-09],[2018-11-10],[2018-11-11],[2018-11-12],[2018-11-13],[2018-11-14],[2018-11-15],[2018-11-16],[2018-11-17],[2018-11-18],[2018-11-19],[2018-11-20],[2018-11-21],[2018-11-22],[2018-11-23],[2018-11-24],[2018-11-25],[2018-11-26],[2018-11-27],[2018-11-28],[2018-11-29],[2018-11-30],[2018-12-01],[2018-12-02],[2018-12-03],[2018-12-04],[2018-12-05],[2018-12-06],[2018-12-07],[2018-12-08],[2018-12-09],[2018-12-10],[2018-12-11],[2018-12-12],[2018-12-13],[2018-12-14],[2018-12-15],[2018-12-16],[2018-12-17],[2018-12-18],[2018-12-19],[2018-12-20],[2018-12-21],[2018-12-22],[2018-12-23],[2018-12-24],[2018-12-25],[2018-12-26],[2018-12-27],[2018-12-28],[2018-12-29],[2018-12-30],[2018-12-31])
		) AS PVT

-----
SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201806 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-06-01' and a.orderdate <='2018-06-31')
   UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201807 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-07-01' and a.orderdate <='2018-07-31')
    UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201808 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-08-01' and a.orderdate <='2018-08-31')
    UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201809 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-09-01' and a.orderdate <='2018-09-31')
    UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201810 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-10-01' and a.orderdate <='2018-10-31')
    UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201811 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-11-01' and a.orderdate <='2018-11-31')
    UNION ALL 
   SELECT t1.sdate as sdate,  t4.storeSubject as storeSubject,t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201812 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
INNER JOIN pos_store as t4 with (nolock) ON t1.storeno=right(t4.storeno,4) and t4.vc_businessStatus='1'
 WHERE  t1.vc = '1' AND  icoop_code ='45041J2300' and t1.storeno ='6223' and (a.orderdate >='2018-12-01' and a.orderdate <='2018-12-31')
 order by sdate


--------------------------------------------------------------------------------
declare @orderdate varchar(max)
select  @orderdate= ''

select  @orderdate = @orderdate+ '[' + orderdate +'],'
 from  ( select distinct orderdate from pos_sale_A01_ppm_daily where (orderdate >= '2018-01-01' and orderdate <='2018-01-31')  group by orderdate  ) A 

select @orderdate = LEFT(@orderdate, LEN(@orderdate) - 1)

declare @Nsql varchar
select  @Nsql = N'
select b.subject, bar_code,c.subject3,f.subject, d.subject, ' +@orderdate+'
from (
select orderdate,b.subject, bar_code,c.subject3,f.subject, d.subject, sum(a.qty_total - a.qty_discount) as sum_jungga 
from pos_sale_A01_ppm_daily as a
LEFT OUTER JOIN pos_product_master as b WITH (NOLOCK) ON a.ppmidx = b.idx 
LEFT OUTER JOIN pos_db_BrandClass as c WITH (NOLOCK) ON b.pdbidx = c.idx
LEFT OUTER JOIN pos_category_master as d WITH (NOLOCK) ON b.pcmidx = d.idx 
LEFT OUTER JOIN pos_category_group as f WITH (NOLOCK) ON d.pcgidx = f.idx
where a.storeno =''8000006223'' and &orderdate >= ''2018-01-01'' and orderdate <=''2018-01-31'')and  b.icoop_code in
(''99913HZ300'',''91544CZ900'',''95076CZ900'',''90555CZ900'',''45140CZ900'',''93500CZ900'',''45014J9000'',''50000HZ300'',''24000IF200'',''34120CZ900'',''46265J9000'',''78912CZ900'',''19037CZ900'',''65625E1900'',''71001CZ900'',''37342I3900'',''00001E7500'',''00002E7500'',''46263J9000'',''46390CZ900'',''89637CZ900'',''46371CZ900'',''15036HZ300'',''48884CZ900'',''10000B9000'',''10002B9000'',''31995B2600'',''55590C3800'',''12345B9000'',''55522C3800'',''54670CE000'',''53603I9100'',''90898CZ900'',''71100CZ900'',''10519CZ900'',''10003BG600'',''10002BG600'',''46260J9000'',''56431E7500'',''46480CZ900'',''00001CX100'',''19097CC600'',''47000J2300'',''37341I3900'',''48885CZ900'',''46560F1800'',''46290F1800'',''37340I3900'',''46530A4300'',''00000CX100'',''19098CC600'',''46110J2300'',''93774CZ900'',''99917HZ300'',''12097CZ900'',''55521C3800'',''10297CZ900'',''34123CZ900'',''10000DF000'',''46480D3200'',''40002BE700'',''10001CZ900'',''90891CZ900'',''71000CZ900'',''10005B7800'',''16893CZ900'',''61104CZ900'',''13712CZ900'',''85000B3300'',''80000B3300'',''45055J2300'',''14000IE000'',''14001IE000'',''41000IE000'',''42000IE000'',''40200EB500'',''50110EB500'',''50100EB500'',''40100EB500'',''40300EB500'',''50300EB500'',''50200EB500'',''11111HZ300'',''90894CZ900'',''46323CZ900'',''99666HZ300'',''45044J2300'',''45041J2300'',''90965CZ900'',''46351CZ900'',''10006B7800'',''10007B7800'',''46012CZ900'',''13000GA500'',''46011CZ900'',''10004FA300'',''10005FA300'',''14000GA500'',''14001GA500'',''10003FA300'',''10002FA300'',''10001FA300'',''35370E7500'',''90899CZ900'',''46100J2300'',''55520C3800'',''15018E1900'',''15017E1900'',''10000BG600'',''10001BG600'',''40003J2300'',''40004J2300'',''40002J2300'',''40001J2300'',''46375CZ900'',''46171D3200'',''46170D3200'',''48889CZ900'',''99777HZ300'',''99888HZ300'',''45015J9000'',''46490D3200'',''40001BE700'',''40000BE700'',''46561F1800'',''46300F1800'',''46210D3200'',''41261E3100'',''46303G1800'',''28001HB700'',''99913HJ300'',''93876CZ900'',''94315CZ900'',''46554B2000'',''14019E1900'',''14021E1900'',''14017E1900'',''00007E1900'',''00015EB500'',''13069E1900'',''55590P6200'',''15022E1900'',''15023E1900'',''63580E6500'',''46329CZ900'',''64566GL400'',''50000A4900'',''46261J2200'',''21261E3100'',''55460B2000'',''46263J2200'',''60802E1900'',''60852E1900'',''60784E1900'',''53900O7500'',''15038E1900'',''15036HJ300'',''99999HZ300'',''15036E1900'',''46551B2000'',''55620P6200'',''53930E1900'',''53920E1900'',''54200E1900'',''53604I9100'',''53955I9100'',''46460E6500'',''37010C6000'',''53950I9100'',''31990B2600'',''35380E7500'',''35390E7500'',''46260J2200'',''56430E7500'',''46553B2000'',''41000IF200'',''55461B2000'',''00008EB500'',''00009EB500'',''64474IB200'',''35800A4900'',''46555B2000'',''53601I9100'',''53951I9100'',''53730I9100'',''53794I9100'',''53791I9100'',''60801E1900'',''60850E1900'',''60782E1900'',''60855E1900'',''60787E1900'',''47046HJ600'',''47045HJ600'',''46010A9500'',''46009A9500'',''11224E1900'',''87665E1900'',''55610P6200'',''63001F1800'',''63003F1800'',''15024E1900'',''53809I9100'',''53952I9100'',''20000C8300'',''45012J2300'',''45015J2300'',''45013J2300'',''37091C6000'',''47090J0900'',''60803E1900'',''60854E1900'',''60786E1900'',''51610G4000'',''20001C8300'',''53732I9100'',''53796I9100'',''53793I9100'',''53790I9100'',''60534E1900'',''60535E1900'',''60532E1900'',''74520B3300'',''74518B2600'',''74519B2600'',''46556B2000'',''46552B2000'',''75113C1400'',''45016J2300'',''37090C6000'',''60570K6300'',''53824E1900'',''53813E1900'',''53816E1900'',''53823E1900'',''53812E1900'',''53815E1900'',''53822E1900'',''53814E1900'',''53817E1900'',''46480A4900'',''46080B2000'',''50401D3200'',''37092C6000'',''46300E7500'',''60000C9700'',''45030J2300'',''63002F1800'',''99891HJ300'',''99891E1900'',''46060A4500'',''15010E1900'',''00003EB500'',''45022J2300'',''46557B2000'',''15012E1900'',''00004EB500'',''46040A4500'',''99894E1900'',''15020E1900'',''15015E1900'',''70991B2000'',''99666HJ300'',''99889HJ300'',''99889E1900'',''46400B2000'',''99888E1900'',''46401B2000'',''45020J2300'',''45070J2300'',''45014J2300'',''90025CD200'',''77734CC700'',''70733C1400'',''70734CC700'',''46490CZ900'',''46331CZ900'',''75111C1400'',''37060C6000'',''13082E1900'',''13082IF200'',''00001CH700'',''10020E1900'',''18002E1900'',''00001BE800'',''55500A5400'',''22800I3300'',''46391CZ900'',''46392CZ900'',''45080J2300'',''61250O7500'',''61260O7500'',''53933O7500'',''53935O7500'',''61230O7500'',''61240O7500'',''61170O7500'',''61180O7500'',''87666E1900'',''15027E1900'',''53811O7500'',''53819O7500'',''53818O7500'',''53820O7500'',''15035E1900'',''99890E1900'',''99887E1900'',''61210O7500'',''61220O7500'',''61190O7500'',''61200O7500'',''61270O7500'',''61280O7500'',''37011C6000'',''54220E1900'',''54320E1900'',''15021E1900'',''18103E1900'',''18003E1900'',''18001E1900'',''18101IF200'',''18101E1900'',''18102E1900'',''18102IF200'',''60800E1900'',''60853E1900'',''60785E1900'',''60856E1900'',''60788E1900'',''19096CC600'',''53602I9100'',''53953I9100'',''53731I9100'',''53795I9100'',''53792I9100'',''77146CC700'',''99913E1900'',''99895E1900'',''99777E1900'',''99777HJ300'',''99888HJ300'',''37094C6000'',''53800I9100'',''53600I9100'',''53954I9100'',''60780E1900'',''60781E1900'',''60779E1900'',''60778E1900'',''10000GA500'',''46005A9500'',''46003A9500'',''45014J2200'',''46540A4300'',''55600P6200'',''35400E7500'',''20490H4200'',''46008A9500'',''46007A9500'',''46000A9500'',''13072E1900'',''13080E1900'',''60804E1900'',''60851E1900'',''60783E1900'',''45050J2300'',''46013A9500'',''46014A9500'',''46011A9500'',''46012A9500'',''46015A9500'',''46016A9500'',''80000F1800'',''14011E1900'',''80001F1800'',''46010A4900'',''35370A4900'',''45040A4900'',''60770A4900'',''15014E1900'',''15013E1900'',''15011E1900'',''00002EB500'',''10000AZ800'',''20000AZ800'',''77183CC700'',''31261E3100'',''75340G4000'',''46011I6400'',''50102A4900'',''46011A4900'',''30000AZ800'',''37093C6000'',''91773IF500'',''34274O1300'',''93000BB400'',''91001UDT00'',''68920GD700'',''75102D3200'',''52001D3200'',''52000D3200'',''51777IF500'',''51002GBC00'',''50976HJ700'',''50971HJ700'',''51001A0400'',''51002A0400'',''51973A0400'',''50973A0400'',''51003A0400'',''50970A0400'',''50980DA900'',''50980A0400'',''50988DA900'',''51000A0400'',''50975A0400'',''34263O1300'',''10624GE300'',''10625GE300'',''62335B1800'',''15000IS500'',''62330B1800'',''15100IS500'',''15200IS500'',''57965B1800'',''10617GE300'',''51550K5600'',''68910GD700'',''00011BB400'',''00012BB400'',''10020IF900'',''10007BB400'',''65000KE300'',''34258O1300'',''10619GE300'',''10015GZ600'',''53318AA000'',''51780IM000'',''10626GE300'',''10627GE300'',''63002KE300'',''67900GD700'',''66900GD700'',''51630D3200'',''26361G2300'',''51775IM000'',''51774IM000'',''51780H4500'',''10623GE300'',''10621GE300'',''10622GE300'',''65105H6800'',''21001KE300'',''51671IF800'',''10581GE300'',''51751IF500'',''51750IF500'',''11114KD500'',''53334AA000'',''34278O1300'',''34276O1300'',''65204H6800'',''84000C7000'',''53320K4000'',''51723C9000'',''10618GE300'',''10566GE300'',''10026IF900'',''10007IF900'',''10001IF900'',''11112KD500'',''11116KD500'',''51641E6500'',''10550GE300'',''70002GC300'',''13708BB400'',''13038IF900'',''53333AA000'',''91000UDT00'',''51735C9000'',''34250I4500'',''51773R0200'',''51773IF500'',''51772IF500'',''51774IF500'',''10629GE300'',''10628GE300'',''50960A0400'',''51005A0400'',''51004A0400'',''50981A0400'',''50960K9800'',''50982A0400'',''54586C1300'',''51787IF500'',''34259O1300'',''34277O1300'',''10037IF900'',''12346AJ400'',''70003D6400'',''51771IM000'',''51760IM000'',''51761IM000'',''34264O1300'',''34253O1300'',''70011D6400'',''11113KD500'',''51721C9000'',''11506BB400'',''11500BB400'',''10038IF900'',''10013IF200'',''13064E1900'',''65103H6800'',''51013E8700'',''51013E6500'',''51010E6500'',''51017D1800'',''51018D1800'',''69801D5400'',''51011E6500'',''69661D2300'',''56570E6500'',''50975E1900'',''50976K9800'',''50975K9800'',''50973E1900'',''51000H7700'',''50972E1900'',''50976E1900'',''50974E1900'',''50974K9800'',''50970K9800'',''51000G5700'',''50971A0400'',''50971K9800'',''51000K9800'',''50971E1900'',''50972A0400'',''50973K9800'',''51000E1900'',''50972E6500'',''50971E6500'',''76100K2300'',''65450D3200'',''70280G5100'',''51730H4500'',''51500A1000'',
''62330B1500'',
''51760R0200'',
''19750D3200'',
''75100D3200'',
''15045E1900'',
''10007E1900'',
''53540K6300'',
''51341K6200'',
''51340K6200'',
''55710K6300'',
''26360G2300'',
''51720H4500'',
''51776R0200'',
''54132K6300'',
''10880K6300'',
''51671M1100'',
''51670M1100'',
''62160G2000'',
''69432C7900'',
''53440K6300'',
''55720K6300'',
''54232K6300'',
''10980K6300'',
''51711A9600'',
''57965B1500'',
''10001J8800'',
''10000J8800'',
''51611E3500'',
''51610GG300'',
''51610C8300'',
''51530A1000'',
''53220C5600'',
''29467P2400'',
''51710H4500'',
''51520D6700'',
''51521D6700'',
''51532D6700'',
''31111D7000'',
''51522D6700'',
''51652E3500'',
''13052E1900'',
''53000E3500'',
''51651E3500'',
''51620E7500'',
''51620J1300'',
''13060E1900'',
''10002J8800'',
''13078E1900'',
''14018E1900'',
''13074E1900'',
''65102H6800'',
''34241M1100'',
''51725C9000'',
''51790H4500'',
''54586KB100'',
''51550K1200'',
''42150E6500'',
''69420I6300'',
''12347AJ400'',
''70004D6400'',
''50000H6100'',
''10200E1900'',
''10010IF200'',
''10014IF200'',
''10015IF200'',
''10009IF200'',
''10006IF200'',
''10007IF200'',
''10008IF200'',
''17777GZ800'',
''10015IB000'',
''10000AAT00'',
''11000AAT00'',
''10001AAT00'',
''53080M4700'',
''45751K7600'',
''45750K7600'',
''41000BF500'',
''45520GA300'',
''45760H2500'',
''45761H2500'',
''10043IF900'',
''45803H6100'',
''55712K9600'',
''72600A8300'',
''72591A8300'',
''47330IC400'',
''10010IB000'',
''80000BB400'',
''17000BF500'',
''17100BF500'',
''45620GA300'',
''69861IB700'',
''23000AAT00'',
''51573D6400'',
''97100H4400'',
''71560H4400'',
''71561H4400'',
''72606A8300'',
''70410A8300'',
''20000AAT00'',
''53062M4700'',
''56001K9600'',
''56002K9600'',
''45590M3200'',
''72602A8300'',
''72593A8300'',
''72592A8300'',
''72601A8300'',
''58000BB400'',
''45602MJ100'',
''45620MJ100'',
''21000AAT00'',
''10000IY100'',
''57200K9600'',
''57100K9600'',
''15000BF500'',
''16000BF500'',
''51571D6400'',
''25000AAT00'',
''24000AAT00'',
''38002BF500'',
''38000BF500'',
''45623D3200'',
''76000D3200'',
''22001BB400'',
''22000BB400'',
''21001BB400'',
''10045IF900'',
''12010AAT00'',
''10000CL000'',
''50010IB000'',
''71411A8300'',
''72603A8300'',
''72594A8300'',
''28000BB400'',
''45650D8000'',
''51568D6400'',
''67311M4700'',
''67310M4700'',
''26000AAT00'',
''45830G6900'',
''42812D1300'',
''70770M3000'',
''38100BF500'',
''67300M4700'',
''67304M4700'',
''67303M4700'',
''45642C7400'',
''45640C7400'',
''99000KM900'',
''80001M4700'',
''80000M4700'',
''10086GZ800'',
''10085GZ800'',
''00003CM400'',
''00001CM400'',
''00004CM400'',
''00002CM400'',
''00005CM400'',
''00006CM400'',
''00007CM400'',
''00008CM400'',
''00009CM400'',
''55441A9900'',
''54115A9900'',
''37000BF500'',
''45650D3200'',
''57000BB400'',
''57002BB400'',
''10450IC100'',
''57000K9600'',
''11461BF500'',
''11475BF500'',
''11451BF500'',
''60002BF500'',
''11471BF500'',
''25000BF500'',
''33001BF500'',
''36000BF500'',
''11460BF500'',
''11462BF500'',
''11476BF500'',
''11477BF500'',
''11452BF500'',
''11453BF500'',
''27000BF500'',
''60000BF500'',
''60001BF500'',
''60003BF500'',
''11472BF500'',
''11473BF500'',
''11474BF500'',
''24000BF500'',
''26000BF500'',
''15100BF500'',
''70440I7800'',
''70441I7800'',
''70450I7800'',
''70451I7800'',
''16100BF500'',
''13001IK400'',
''13000IK400'',
''12001IK400'',
''12002IK400'',
''31000BB400'',
''00017BB400'',
''91710H4400'',
''72578A8300'',
''72579A8300'',
''70416A8300'',
''56101K9600'',
''56102K9600'',
''45330IC400'',
''45601MJ100'',
''45610MJ100'',
''50001IB000'',
''67111M4700'',
''67110M4700'',
''54225M4700'',
''13041E1900'',
''32000BF500'',
''20001BB400'',
''13019BB400'',
''60001BB400'',
''10018IF900'',
''72595A8300'',
''72604A8300'',
''10001IC100'',
''10002IC100'',
''22000AAT00'',
''46330IC400'',
''39000BF500'',
''45710D3200'',
''45804H6100'',
''45802H6100'',
''13060AA900'',
''36001BF500'',
''10012IF200'',
''10011IF200'',
''NB101O7700'',
''NB116O7700'',
''NB124O7700'',
''13102E1900'',
''45500M3000'',
''45545IB000'',
''72605A8300'',
''72576A8300'',
''12365BB400'',
''11446BB400'',
''11447BB400'',
''45540M3000'',
''45510H2500'',
''45750H2500'',
''13000BF500'',
''33000BB400'',
''13112E1900'',
''11462BB400'',
''13056AA900'',
''55710K9600'',
''55711K9600'',
''55751K9600'',
''72571A8300'',
''11481E8800'',
''45541IB000'',''45540IB000'',''53061M3300'',''70410M3900'',''13104E1900'',''13103E1900'',''13107E1900'',''13100E1900'',''45591K7600'',''45601M3200'',''45600M3200'',''45610M3200'',''72573A8300'',''72583A8300'',''35431D3200'',''72572A8300'',''72582A8300'',''45810E1100'',''55730K9600'',''55731K9600'',''45690M2400'',''47070K9600'',''10004IB000'',''45544IB000'',''45621D3200'',''45622D3200'',''45543IB000'',''58266C6500'',''58265C6500'',''34572H4900'',''70442I7800'',''72574A8300'',''72584A8300'',''45650H7000'',''69220A8300'',''55726K9600'',''45670D8000'',''57970D8000'',''11004II300'',''69542J1500'',''71063M3000'',''45530M3000'',''67200M4700'',''45640K9600'',''63489A8300'',''63488A8300'',''13105E1900'',''69451M2700'',''30412M4700'',''45641D3200'',''45630D3200'',''55750K9600'',''45490M3000'',''11449BB400'',''12000BF500'',''14000BF500'',''11448BB400'',''11450BB400'',''53281I1100'',''22992M3300'',''22990M3300'',''13049A6300'',''45662M2400'',''11002II300'',''45660M2400'',''45730G2000'',''18000BF500'',''55720K9600'',''55721K9600'',''72577A8300'',''72570A8300'',''13044E1900'',''13109E1900'',''45600MJ100'',''45611MJ100'',''69870K3900'',''69860K3900'',''67100M4700'',''47060K9600'',''13056E1900'',''13057E1900'',''13058E1900'',''13111E1900'',''13108E1900'',''55620K8000'',''55630K8000'',''45470M3000'',''72575A8300'',''45831E1100'',''45832E1100'',''45830K9600'',''45828E1100'',''45830E1100'',''45833E1100'',''45829E1100'',''45284E1100'',''70411A8300'',''72607A8300'',''45480M3000'',''55725K9600'',''79397AX600'',''79378AX600'',''79404AX600'',''79377AX600'',''79379AX600'',''79396AX600'',''67811Q1600'',''77564Q1600'',''44010C2500'',''44220J4100'',''77582Q1600'',''79395AX600'',''79394AX600'',''44115C5200'',''77583Q1600'',''67800Q1600'',''77563Q1600'',''77579Q1600'',''55240J4100'',''44040C2500'',''77560Q1600'',''77562Q1600'',''44094C5200'',''77556Q1600'',''79502AX600'',''79372AX600'',''79406AX600'',''79503AX600'',''79501AX600'',''79504AX600'',''79371AX600'',''79405AX600'',''44011CG100'',''44012CG100'',''79376AX600'',''79409AX600'',''77570Q1600'',''44095C5200'',''10001GZA00'',''10003GZA00'',''10002GZA00'',''77584Q1600'',''77557Q1600'',''77558Q1600'',''55240J2100'',''77552Q1600'',''44200J2100'',''44520C1200'',''44220J2100'',''79399AX600'',''79398AX600'',''44080C5200'',''44081C5200'',''72020AS700'',''44180C1200'',''77581Q1600'',''44090C5200'',''44091C5200'',''44050C1200'',''44210J2100'',''97305C9800'',''44110C5200'',''55260A6900'',''77551Q1600'',''79401AX600'',''44111C5200'',''44112C5200'',''79374AX600'',''44114C5200'',''44113C5200'',''44060C2500'',''44060J2100'',''44060J4100'',''79420Q1600'',''44100C5200'',''44190C1200'',''77555Q1600'')
group by orderdate,bar_code,b.subject,c.subject3,f.subject, d.subject
order by orderdate
) T
	Pivot (sum(sum_jungga) For orderdate in ('+ @orderdate +') 
	) AS PVT

order by orderdate desc
'
print @NSQL


-----------------------------------------------

DECLARE @icoop_code varchar(20)
DECLARE @storeno varchar(4)
DECLARE @storeno1 varchar(10)


set  @storeno1 ='8000006151'
set  @storeno ='6151'

set  @icoop_code ='51775IM000' --ººÀº¼Ò±İ

SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201801 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-01-01' and  t1.orderdate <='2018-01-31')
    UNION ALL 
SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201802 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-02-01' and  t1.orderdate <='2018-02-31')
    UNION ALL 
SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201803 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-03-01' and  t1.orderdate <='2018-03-31')
     UNION ALL 
SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201804 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-04-01' and  t1.orderdate <='2018-04-31')
     UNION ALL 
SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201805 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-05-01' and  t1.orderdate <='2018-05-31')
     UNION ALL 
SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201806 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-06-01' and  t1.orderdate <='2018-06-10')
order by t1.orderdate


--------------------------------
SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201806 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and  (sdate >=CAST( '2018-06-01' as date) and  sdate <=CAST( '2018-06-30' as date)  )
   UNION ALL 
   SELECT t1.sdate as sdate, t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201807 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx
 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and (sdate >=CAST( '2018-07-01' as date) and  sdate <=CAST( '2018-07-31' as date)  )
    UNION ALL 
   SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201808 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx

 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and  (sdate >=CAST( '2018-08-01' as date) and  sdate <=CAST( '2018-08-31' as date)  )
    UNION ALL 
   SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201809 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx

 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and (sdate >=CAST( '2018-09-01' as date) and  sdate <=CAST( '2018-09-30' as date)  )
    UNION ALL 
   SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201810 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx

 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and  (sdate >=CAST( '2018-10-01' as date) and  sdate <=CAST( '2018-10-31' as date)  )
    UNION ALL 
   SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201811 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx

 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and  (sdate >=CAST( '2018-11-01' as date) and  sdate <=CAST( '2018-11-30' as date)  )
    UNION ALL 
   SELECT t1.sdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result,
t1.scm_gb, t1.stock_only_ab, t1.reg_gb,  t1.scm_susik, t1.amt_bundle, t1.amt_balju_pre, t1.amt_balju,
 t1.amt_sale_d3, t1.amt_sale_d2, t1.amt_sale_d1, t1.amt_sale_d,
  t1.amt_pda_d3, t1.amt_pda_d2, t1.amt_pda_d1, t1.amt_safe_d,
   t1.amt_magam, t1.amt_input_d3, t1.amt_input_d2, t1.amt_input_d1, 
   t1.amt_adjust1, t1.amt_adjust2, t1.amt_adjust3, t1.amt_adjust4, t1.amt_adjust5, t1.amt_adjust6, t1.amt_adjust7
FROM 
WEBDB_SE.dbo.stock_preset4_2018 as t1 with (nolock)
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_store_stock_201812 as a with (nolock) ON t3.idx  = a.ppmidx  and t1.sdate = a.orderdate and t1.storeno = right(a.storeno,4)
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.sdate = s2.orderdate and a.storeno = s2.storeno and a.ppmidx = s2.ppmidx

 WHERE  t1.vc = '1' AND  icoop_code =@icoop_code and t1.storeno =@storeno and  (sdate >=CAST( '2018-12-01' as date) and  sdate <=CAST( '2018-12-31' as date)  )
 order by sdate

 -------------------

 SELECT t1.orderdate as sdate,  t3.bar_code, amt_input, amt_sale , isnull(qty_total - qty_discount,0) as amt_sale_jungga,  amt_result
FROM 
 pos_store_stock_201809 as t1 with (nolock) 
LEFT OUTER JOIN pos_product_master as t3 with (nolock) ON t1.ppmidx = t3.idx 
LEFT OUTER JOIN pos_sale_a01_ppm_daily as s2 with (nolock) ON t1.orderdate = s2.orderdate and  t1.storeno = s2.storeno and  t1.ppmidx = s2.ppmidx
 WHERE   icoop_code =@icoop_code and t1.storeno =@storeno1 and ( t1.orderdate >='2018-09-24' and  t1.orderdate <='2018-09-25')


